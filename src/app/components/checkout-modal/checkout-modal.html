<div class="modal-overlay" (click)="close.emit()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    
    <!-- HEADER -->
    <div class="modal-header">
      <h2>üìã Finaliser la commande</h2>
      <button class="close-btn" 
              (click)="close.emit()" 
              [disabled]="isSubmitting"
              aria-label="Fermer">
        √ó
      </button>
    </div>

    <!-- BODY -->
    <div class="modal-body">
      
      <!-- SUMMARY BOX -->
      <p class="summary-text">
        Vous avez <strong>{{ cartItems.length }} article{{ cartItems.length > 1 ? 's' : '' }}</strong> 
        pour un total de <strong>{{ totalPrice + 7 }} TND</strong> (livraison incluse).
      </p>

      <!-- FORM -->
      <form (ngSubmit)="submitOrder()">
        
        <!-- NOM -->
        <div class="form-group">
          <label for="nom">Nom et Pr√©nom *</label>
          <input 
            type="text" 
            id="nom"
            [(ngModel)]="formData.nom" 
            name="nom" 
            required 
            placeholder="Ex: Ahmed Ben Salem"
            autocomplete="name">
        </div>

        <!-- T√âL√âPHONE -->
<div class="form-group">
          <label for="telephone">Num√©ro de t√©l√©phone *</label>
          <input 
            type="tel" 
            id="telephone"
            [(ngModel)]="formData.telephone" 
            name="telephone" 
            required 
            minlength="8" 
            maxlength="8" 
            pattern="[0-9]{8}"
            inputmode="numeric"
            oninput="this.value = this.value.replace(/[^0-9]/g, '')"
            placeholder="Ex: 22123456"
            autocomplete="tel">
            
            <div *ngIf="formData.telephone && formData.telephone.length !== 8" style="color: red; font-size: 0.8rem; margin-top: 5px;">
               Le num√©ro doit contenir exactement 8 chiffres.
            </div>
        </div>

        <!-- ADRESSE -->
        <div class="form-group">
          <label for="adresse">Adresse de livraison *</label>
          <textarea 
            id="adresse"
            [(ngModel)]="formData.adresse" 
            name="adresse" 
            required 
            placeholder="Ex: 15 Rue de la Libert√©, Tunis 1000"
            autocomplete="street-address"></textarea>
        </div>

        <!-- EMAIL -->
        <div class="form-group">
          <label for="email">Email (Optionnel)</label>
          <input 
            type="email" 
            id="email"
            [(ngModel)]="formData.email" 
            name="email" 
            placeholder="Pour recevoir la confirmation"
            autocomplete="email">
        </div>

        <!-- SUBMIT BUTTON -->
        <button 
          type="submit" 
          class="submit-btn" 
          [disabled]="isSubmitting">
          <span *ngIf="!isSubmitting">
            ‚úì Confirmer la commande
          </span>
          <span *ngIf="isSubmitting">
            ‚è≥ Envoi en cours...
          </span>
        </button>

      </form>
    </div>

  </div>
</div>